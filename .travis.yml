language: node_js

node_js:
  - "5"

services:
  - docker
sudo: required

before_install:
 - chmod +x wait-for-it.sh



before_script:
  - docker run -d -p 3307:3306 --name aggregator-mysql -e MYSQL_ROOT_PASSWORD=59722795 -e MYSQL_DATABASE=rss_aggregator  mysql:5.7
  - bash ./wait-for-it.sh aggregator-mysql:3307 -t 999 
  - docker run -d -p 1337:1337  --link aggregator-mysql -e DATABASE_HOST=aggregator-mysql aggregator sails lift
  - bash ./wait-for-it.sh aggregator:1337 -t 999 
  - grunt testServer"
  